(ns lyric-backend.rhyme-detection.simple-rhyme-detection)(defn- matching-tail-n? [w1 w2 n]  (let [c1 (count w1)        c2 (count w2)]    (when (and (>= c1 n)               (>= c2 n))      (= (subs w1 (- c1 n) c1)         (subs w2 (- c2 n) c2)))))(defn- matching-tail-4? [w1 w2]  (matching-tail-n? w1 w2 4))(defn- only-first-letters-differ? [w1 w2]  (and    (= (rest w1)       (rest w2))    (not= (first w1)          (first w2))))(defn rhyme-detected? [w1 w2]  (or    (matching-tail-4? w1 w2)    (only-first-letters-differ? w1 w2)))